{"version":3,"sources":["local-conference.js"],"names":["$","document","ready","length","initDatatable","table","filter","search","form","input","pagination","basic","columns","data","className","render","type","row","on","e","preventDefault","selected","this","val","$dioceses","console","log","includes","find","prop","css","toUpperCase","window","location","split","$current_dioceses","dirty","has_invalid_diocesan_council","invalid_diocesan_council_id","$this","bootbox","dialog","message","buttons","cancel","label","callback","discard","attr","save","text","ajaxSubmit","formData","filters","state","diocesan_council_id","status","is_flagged","regional_council","state_council","value","localconf_export_url","param","jQuery"],"mappings":"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","file":"local-conference.min.js","sourcesContent":["/* global has_invalid_diocesan_council */\r\n/* global invalid_diocesan_council_id */\r\n/* global bootbox */\r\n/* global initDatatable */\r\n/* global localconf_export_url */\r\n\r\n'use strict';\r\n\r\n(function ($) {\r\n\r\n    $(document).ready(function () {\r\n        if ($('.js-table').length) {\r\n            initDatatable({\r\n                table: '.js-table',\r\n                filter: '.js-table-filter',\r\n                search: {\r\n                    form: '.js-table-search-form',\r\n                    input: '.js-table-search-input',\r\n                },\r\n                pagination: {\r\n                    basic: '.pagination-basic',\r\n                    table: '.pagination-table',\r\n                },\r\n                columns: [\r\n                    {\r\n                        data: 'id',\r\n                        className: 'text-center',\r\n                        render: function (data, type, row) {\r\n                            return '<a href=\"/local-conferences/edit/' + data + '\">' + data + '</a>';\r\n                        },\r\n                    },\r\n                    {\r\n                        data: 'name',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'parish',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'status',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'state_council',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'diocesan_council_id',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'regional_council',\r\n                        className: 'text-center',\r\n                    },\r\n                   \r\n                ]\r\n            });\r\n        }\r\n\r\n        $('[name=\"state_council\"]').on('change', function (e) {\r\n            e.preventDefault();\r\n            var selected  = $(this).val();           \r\n            var $dioceses = $('[name=\"diocesan_council_id\"]');\r\n\r\n            console.log(selected);\r\n\r\n            if ( selected.includes('national') ) {\r\n                // enable all diocesan/central council\r\n                $dioceses.find('option').prop('disabled', false);\r\n                $dioceses.find('option').prop('selected', false); \r\n                $dioceses.find('optgroup').css(\"display\",\"inline\");\r\n\r\n            } else {\r\n                //$dioceses.find('option').prop('disabled', true);\r\n                $dioceses.find('option').prop('selected', false);\r\n                $dioceses.find('optgroup').css(\"display\",\"none\");\r\n\r\n                $dioceses.find('optgroup[label=\"' + selected.toUpperCase() + '\"]').find('option').prop('disabled', false);\r\n                $dioceses.find('optgroup[label=\"' + selected.toUpperCase() + '\"]').css(\"display\",\"inline\");\r\n            }\r\n        })\r\n\r\n        var pathname = (window.location.pathname).split('/');\r\n\r\n        if (pathname.includes('edit')) { // check if edit page \r\n            var selected  = $('[name=\"state_council\"]').val();           \r\n            var $current_dioceses = $('[name=\"diocesan_council_id\"]').val();\r\n            var $dioceses = $('[name=\"diocesan_council_id\"]');\r\n\r\n            if ( selected.includes('national') ) {\r\n                // enable all diocesan/central council\r\n                $dioceses.find('option').prop('disabled', false);\r\n                $dioceses.find('option').prop('selected', false); \r\n                $dioceses.find('optgroup').css(\"display\",\"inline\");\r\n\r\n            } else {\r\n                $dioceses.find('option').prop('selected', false);\r\n                $dioceses.find('optgroup').css(\"display\",\"none\");\r\n\r\n                $dioceses.find('optgroup[label=\"' + selected.toUpperCase() + '\"]').find('option').prop('disabled', false);\r\n                $dioceses.find('optgroup[label=\"' + selected.toUpperCase() + '\"]').find('option[value=\"' + $current_dioceses + '\"]').prop('selected', true);\r\n                $dioceses.find('optgroup[label=\"' + selected.toUpperCase() + '\"]').css(\"display\",\"inline\");\r\n            }\r\n        }\r\n\r\n        if ($('.form-edit-local-conf').length) {\r\n            $('.form-edit-local-conf').dirty();\r\n\r\n            if (has_invalid_diocesan_council) {\r\n                $('#diocesan_council_id').find('option[value=\"' + invalid_diocesan_council_id +'\"]').prop('disabled', true);\r\n            }\r\n\r\n            $('.js-btn-add-twinning').on('click', function (e) {\r\n                var $this = $(this);\r\n\r\n                if ($('.form-edit-local-conf').dirty('isDirty')) {\r\n                    e.preventDefault();\r\n\r\n                    bootbox.dialog({\r\n                        message: 'You might have unsaved changes for the Australian Conference you are trying to add a twin. Would you like to save the changes, discard changes or Cancel and take time to review the modifications?',\r\n                        buttons: {\r\n                            cancel: {\r\n                                label: 'Cancel and Review',\r\n                                className: 'btn-warning',\r\n                                callback: function() {\r\n                                    // do nothing\r\n                                }\r\n                            },\r\n                            discard: {\r\n                                label: 'Discard Changes',\r\n                                className: 'btn-danger',\r\n                                callback: function() {\r\n                                    window.location = $this.attr('href');\r\n                                }\r\n                            },\r\n                            save: {\r\n                                label: 'Save Changes',\r\n                                className: 'btn-primary',\r\n                                callback: function() {\r\n                                    $('[data-bb-handler=\"save\"]').text('Saving...');\r\n\r\n                                    $('.js-form').ajaxSubmit(function () {\r\n                                        $('[data-bb-handler=\"save\"]').text('Redirecting...');\r\n\r\n                                        window.location = $this.attr('href');\r\n                                    });\r\n\r\n                                    $('[data-bb-handler=\"save\"]').text('Save Changes');\r\n\r\n                                    return false; // dont close the modal\r\n                                }\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n        $(document).on('click', '.js-btn-export-local-conf', function (e) {\r\n            e.preventDefault();\r\n\r\n            var formData = {\r\n                filters: {\r\n                    state: $('[name=\"state\"]').find('option:selected').val(),\r\n                    diocesan_council_id: $('[name=\"diocesan_council_id\"]').find('option:selected').val(),\r\n                    status: $('[name=\"status\"]').find('option:selected').val(),\r\n                    is_flagged: $('[name=\"is_flagged\"]').find('option:selected').val(),\r\n                    regional_council: $('[name=\"regional_council\"]').val(),\r\n                    state_council: $('[name=\"state_council\"]').find('option:selected').val(),\r\n                },\r\n                search: {\r\n                    value: $('.js-table-search-input').val(),\r\n                }\r\n            };\r\n\r\n            window.location = localconf_export_url + '?' + $.param(formData);\r\n        });\r\n    });\r\n})(jQuery);\r\n"]}

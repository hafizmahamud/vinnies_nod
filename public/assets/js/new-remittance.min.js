"use strict";!function(t){var e=t("#mustache-project-donations").html(),a=t("#mustache-twinning-donations").html(),n=t("#mustache-grant-donations").html(),r=t("#mustache-council-donations").html();Mustache.parse(e),Mustache.parse(a),Mustache.parse(n),Mustache.parse(r);var s=function(o,c){t.get(remittance_donation_url,{document_id:o,type:c},function(o){var i,m;switch(c){case types.projects:m=e,i="project";break;case types.twinning:m=a,i="twinning";break;case types.grants:m=n,i="grant";break;case types.council:m=r,i="council"}t('.remittance-donations[data-type="'+c+'"]').html(Mustache.render(m,o)),updateBindings(o.total),initForm({form:".js-remittance-document-form-"+i,btn:".js-remittance-document-form-"+i+' button[type="submit"]',successCb:function(t,e,a,n){s(t.id,t.type)},errorCb:function(t,e,a){var n=JSON.parse(t.responseText);n.errors.document.length&&showDialog(n.errors.document[0],!1)}}),initForm({form:".js-delete-document-form-"+i,btn:".js-delete-document-form-"+i+' button[type="submit"]',successCb:function(t,e,a,n){s(!1,t.type)}})}).fail(function(t,e,a){var n=JSON.parse(t.responseText);"dialog"===n.type&&showDialog(n.msg,n.confirm)}).always(function(){updateUpdatedBy()})};t(document).ready(function(){t(".js-table").length&&initDatatable({table:".js-table",filter:".js-table-filter",search:{form:".js-table-search-form",input:".js-table-search-input"},pagination:{basic:".pagination-basic",table:".pagination-table"},columns:[{data:"id",className:"text-center",render:function(t,e,a){return'<a href="/remittances/new/edit/'+t+'">'+t+"</a>"}},{data:"state",className:"text-center"},{data:"date",className:"text-center"},{data:"created_at",className:"text-center"},{data:"approved_at",className:"text-center"},{data:"quarter",className:"text-center"},{data:"year",className:"text-center"},{data:"total",className:"text-center"},{data:"projects",className:"text-center"},{data:"twinning",className:"text-center"},{data:"grants",className:"text-center"},{data:"councils",className:"text-center"},{data:"is_approved",className:"text-center"}]}),t(".remittance-donations").length&&t(".remittance-donations").each(function(){s(!1,t(this).data("type"))}),t(".new-remittance-edit-form").length&&(t(".js-btn-approve-remittance").on("click",function(e){e.preventDefault();var a=t(this);showDialog("Are you sure you want to approve and process this remittance?",!0,function(){window.location=a.attr("href")})}),t(".js-btn-unapprove-remittance").on("click",function(e){e.preventDefault();var a=t(this);showDialog("Are you sure you want to reinstate edit mode for this remittance?<br><br><strong>After confirmation, please remember to delete Project Payments automatically added by this remittance on previous approval.</strong>",!0,function(){window.location=a.attr("href")})}))})}(jQuery);
//# sourceMappingURL=new-remittance.min.js.map

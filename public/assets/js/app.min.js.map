{"version":3,"sources":["app.js"],"names":["$","calculatePaginationRange","currentPage","totalPages","startPage","endPage","Math","min","ajaxSetup","headers","X-CSRF-TOKEN","attr","fn","select2","defaults","set","docTmpl","html","isBottomNavBar","Mustache","parse","documents","numberFormat","number","decimals","dec_point","thousands_sep","replace","n","isFinite","prec","abs","sep","dec","s","k","pow","round","toFixed","split","length","Array","join","debounce","delay","timer","context","this","args","arguments","clearTimeout","setTimeout","apply","showFormErrors","errors","$el","each","key","val","find","text","show","$input","closest","addClass","remove","append","showDialog","msg","confirm","confirmCb","bootbox","message","buttons","label","className","cancel","callback","result","window","alert","ok","showAlert","type","removeClass","animate","scrollTop","offset","top","clearAlert","selectRow","el","not","prop","toggleClass","hasClass","updateBindings","data","cb","tagName","toLowerCase","console","warn","initDatatable","config","$table","table","$filter","filter","$dataTable","DataTable","paging","searching","info","serverSide","processing","retrieve","searchDelay","order","ajax","url","d","search","input","value","page","start","filters","name","columns","rowCallback","row","$row","DT_RowId","drawCallback","settings","pagination","json","$pBasic","basic","$pTable","$btn","document","getElementById","scrollIntoView","current","last","total","first","next","hide","prev","range","push","i","empty","throttledSearch","dataTable","util","throttle","draw","on","parseInt","off","e","preventDefault","target","form","initForm","$formEl","ajaxForm","clearForm","trim","resetForm","beforeSubmit","btn","beforeSubmitCb","success","responseText","statusText","xhr","$form","successCb","location","redirect","error","status","JSON","errorCb","complete","completeCb","$this","contains","submit","updateDocuments","$container","id","tooltip","get","resp","render","always","updateUpdatedBy","meta_url","loadComments","res","index","date","diff","comment","ready","toggle","filepath","basename","datepicker","format","autoHide","endDate","autosize","documentable_type","documentable_id","modal","relatedTarget","docId","ind","filename","comments_raw","update","reset","post","fail","change","action","prevYear","selectedYear","new_action","split_url","split_date","date_start","new_start","date_end","new_end","jQuery"],"mappings":"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","file":"app.min.js","sourcesContent":["/* global columnConfig:true */\r\n/* global bootbox */\r\n/* global rome */\r\n/* global Mustache */\r\n/* global autosize */\r\n/* global documentable_type */\r\n/* global documentable_id */\r\n/* global meta_url */\r\n/* global causer_type */\r\n/* global id */\r\n\r\n'use strict';\r\n\r\n(function ($) {\r\n    $.ajaxSetup({\r\n        headers: { 'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content') }\r\n    });\r\n\r\n    $.fn.select2.defaults.set('theme', 'bootstrap');\r\n\r\n    var docTmpl = $('#mustache-documents').html();\r\n    var isBottomNavBar = false;\r\n    Mustache.parse(docTmpl);\r\n\r\n    var documents; // will hold all documents data from current view\r\n\r\n    var numberFormat = function(number, decimals, dec_point, thousands_sep) {\r\n        number     = (number + '').replace(/[^0-9+\\-Ee.]/g, '');\r\n        var n      = !isFinite(+number) ? 0 : +number,\r\n        prec       = !isFinite(+decimals) ? 0 : Math.abs(decimals),\r\n        sep        = (typeof thousands_sep === 'undefined') ? ',' : thousands_sep,\r\n        dec        = (typeof dec_point === 'undefined') ? '.' : dec_point,\r\n        s          = '',\r\n        toFixedFix = function (n, prec) {\r\n            var k = Math.pow(10, prec);\r\n            return '' + (Math.round(n * k) / k).toFixed(prec);\r\n        };\r\n\r\n        s = (prec ? toFixedFix(n, prec) : '' + Math.round(n)).split('.');\r\n\r\n        if (s[0].length > 3) {\r\n            s[0] = s[0].replace(/\\B(?=(?:\\d{3})+(?!\\d))/g, sep);\r\n        }\r\n\r\n        if ((s[1] || '').length < prec) {\r\n            s[1] = s[1] || '';\r\n            s[1] += new Array(prec - s[1].length + 1)\r\n            .join('0');\r\n        }\r\n\r\n        return s.join(dec);\r\n    };\r\n\r\n    var debounce = function(fn, delay) {\r\n        var timer = null;\r\n\r\n        return function () {\r\n            var context = this, args = arguments;\r\n\r\n            clearTimeout(timer);\r\n\r\n            timer = setTimeout(function () {\r\n                fn.apply(context, args);\r\n            }, delay);\r\n        };\r\n    }\r\n\r\n    var showFormErrors = function (errors, $el) {\r\n        $.each(errors, function (key, val) {\r\n            if ($el.find('[data-error=\"' + key + '\"]').length) {\r\n                $el.find('[data-error=\"' + key + '\"]').text(val[0]).show();\r\n            } else {\r\n                var $input = $el.find('[name=\"' + key + '\"]');\r\n\r\n                if (!$input.length) {\r\n                    $input = $el.find('[name=\"' + key + '[]\"]'); // probably array\r\n                }\r\n\r\n                $input.closest('.form-group').addClass('has-error');\r\n\r\n                if (val.length) {\r\n                    $input.closest('.form-group').find('.help-block').remove();\r\n                    $input.closest('.form-group').append('<span class=\"help-block\">' + val[0] + '</span>');\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    var showDialog = function(msg, confirm, confirmCb) {\r\n        if (confirm) {\r\n            bootbox.confirm({\r\n                message: msg,\r\n                buttons: {\r\n                    confirm: {\r\n                        label: 'Confirm',\r\n                        className: 'btn-warning'\r\n                    },\r\n                    cancel: {\r\n                        label: 'Cancel',\r\n                        className: 'btn-primary'\r\n                    }\r\n                },\r\n                callback: function (result) {\r\n                    if (!result) {\r\n                        return;\r\n                    }\r\n\r\n                    // global callback a priority\r\n                    if (window.confirmCb) {\r\n                        window.confirmCb();\r\n                    } else if (confirmCb) {\r\n                        confirmCb();\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            bootbox.alert({\r\n                message: msg,\r\n                buttons: {\r\n                    ok: {\r\n                        className: 'btn-primary'\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    var showAlert = function (msg, type) {\r\n        $('[data-alert]').removeClass().addClass('alert alert-' + type).find('.msg').text(msg);\r\n        $('html, body').animate({ scrollTop: $('[data-alert]').offset().top - 50 });\r\n    };\r\n\r\n    var clearAlert = function () {\r\n        $('[data-alert]').removeClass().addClass('hidden').find('.msg').text('');\r\n    };\r\n\r\n    var selectRow = function (el) {\r\n        var $el = $(el);\r\n\r\n        $el.closest('tbody').find('tr').not($el).removeClass('success');\r\n        $el.closest('tbody').find('input[type=\"checkbox\"]').not($el).prop('checked', false);\r\n        $el.toggleClass('success');\r\n        $el.find('input[type=\"checkbox\"]').prop('checked', $el.hasClass('success'));\r\n    };\r\n\r\n    var updateBindings = function (data, cb) {\r\n        $.each(data, function (key, val) {\r\n            var $el = $('[data-bind=\"' + key + '\"]');\r\n\r\n            if (!$el.length) {\r\n                return;\r\n            }\r\n\r\n            var tagName = $el.prop('tagName').toLowerCase();\r\n\r\n            switch (tagName) {\r\n                case 'input':\r\n                    $el.val(val);\r\n                    break;\r\n\r\n                case 'a':\r\n                    if ($el.data('bind-attr') === 'href') {\r\n                        $el.attr('href', val);\r\n                    } else {\r\n                        $el.text(val);\r\n                    }\r\n                    break;\r\n\r\n                case 'span':\r\n                case 'p':\r\n                case 'strong':\r\n                    $el.text(val);\r\n                    break;\r\n\r\n                default:\r\n                    console.warn('Invalid tagName: ' + tagName);\r\n                    break;\r\n            }\r\n        });\r\n\r\n        if (cb) {\r\n            cb(data);\r\n        }\r\n    };\r\n\r\n    function calculatePaginationRange(currentPage, totalPages) {\r\n      var numPagesToShow = Math.min(totalPages, 5);\r\n      var startPage;\r\n      var endPage;\r\n\r\n      if (totalPages <= 5) {\r\n          startPage = 1;\r\n          endPage = totalPages;\r\n      } else {\r\n          if (currentPage <= 3) {\r\n              startPage = 1;\r\n              endPage = 5;\r\n          } else if (currentPage >= totalPages - 2) {\r\n              startPage = totalPages - 4;\r\n              endPage = totalPages;\r\n          } else {\r\n              startPage = currentPage - 2;\r\n              endPage = currentPage + 2;\r\n          }\r\n      }\r\n\r\n      return { startPage: startPage, endPage: endPage };\r\n  }\r\n\r\n    var initDatatable = function (config) {\r\n        var $table  = $(config.table);\r\n        var $filter = $(config.filter);\r\n\r\n        var $dataTable = $table.DataTable({\r\n            paging: false,\r\n            searching: false,\r\n            info: false,\r\n            serverSide: true,\r\n            processing: true,\r\n            retrieve: true,\r\n            searchDelay: 250,\r\n            order: [[ $table.data('order-col'), $table.data('order-type') ]],\r\n            ajax: {\r\n                url: $table.data('url'),\r\n                data: function (d) {\r\n                    if ($(config.search.input).length) {\r\n                        d.search.value = $(config.search.input).val();\r\n                    } else {\r\n                        d.search.value = '';\r\n                    }\r\n\r\n                    d.length       = $table.data('page-length');\r\n                    d.page         = (d.start / d.length) + 1;\r\n\r\n                    if ($filter.length) {\r\n                        d.filters = {};\r\n\r\n                        $filter.find('input, select, textarea').each(function () {\r\n                            var $el = $(this);\r\n                            var name = $el.attr('name');\r\n                            var val;\r\n\r\n                            switch ($el.prop('nodeName').toLowerCase()) {\r\n                                default:\r\n                                    val = $el.val();\r\n                                    break;\r\n                            }\r\n\r\n                            d.filters[name] = val;\r\n                        });\r\n                    }\r\n                }\r\n            },\r\n            columns: config.columns,\r\n            rowCallback: function(row, data) {\r\n                if (!$table.hasClass('js-modal-table')) {\r\n                    return;\r\n                }\r\n\r\n                var $row = $(row);\r\n\r\n                if (data.DT_RowId === 'row_' + $(config.table).attr('data-selected-id')) {\r\n                    $row.addClass('success');\r\n                    $row.find('input[type=\"checkbox\"]').prop('checked', true);\r\n                } else {\r\n                    $row.removeClass('success');\r\n                    $row.find('input[type=\"checkbox\"]').prop('checked', false);\r\n                }\r\n            },\r\n            drawCallback: function (settings) {\r\n                var pagination = settings.json.pagination;\r\n                var html       = [];\r\n                var $pBasic    = $(config.pagination.basic);\r\n                var $pTable    = $(config.pagination.table);\r\n                var $btn       = $filter.find('[type=\"submit\"]');\r\n\r\n                $btn.text($btn.data('text-default'));\r\n                if(isBottomNavBar === true){\r\n                    var element = document.getElementById(\"site-footer\");\r\n                    element.scrollIntoView(true);   \r\n                }             \r\n\r\n                if ($pBasic.length) {\r\n                    $pBasic.find('.page-status').text(pagination.current + ' of ' + pagination.last);\r\n                    $pBasic.find('.page-total').text(pagination.total + ' item' + (pagination.total > 1 ? 's' : ''));\r\n                    $pBasic.find('[data-page=\"first\"]').attr('href', pagination.url.first);\r\n                    $pBasic.find('[data-page=\"last\"]').attr('href', pagination.url.last);\r\n\r\n                    if (pagination.url.next) {\r\n                        $pBasic.find('[data-page=\"next\"]').attr('href', pagination.url.next).show();\r\n                    } else {\r\n                        $pBasic.find('[data-page=\"next\"]').hide();\r\n                    }\r\n\r\n                    if (pagination.url.prev) {\r\n                        $pBasic.find('[data-page=\"previous\"]').attr('href', pagination.url.prev).show();\r\n                    } else {\r\n                        $pBasic.find('[data-page=\"previous\"]').hide();\r\n                    }\r\n                }\r\n\r\n                if ($pTable.length) {\r\n                  var currentPage = pagination.current;\r\n                  var totalPages = pagination.last;\r\n                  var range = calculatePaginationRange(pagination.current, pagination.last);\r\n                  html.push(\r\n                    '<li><a href=\"#\" class=\"page-first js-table-pager\" data-page=\"first\">&laquo;</a></li>'\r\n                  );\r\n                  html.push(\r\n                    '<li><a href=\"#\" class=\"page-prev js-table-pager\" data-page=\"previous\">&lsaquo;</a></li>'\r\n                  );\r\n        \r\n                  for (var i = range.startPage; i <= range.endPage; i++) {\r\n                    if (i === currentPage) {\r\n                      html.push('<li class=\"active\"><span>' + i + \"</span></li>\");\r\n                    } else {\r\n                      html.push(\r\n                        '<li><a href=\"#\" class=\"js-table-pager\" data-page=\"' +\r\n                          (i - 1) +\r\n                          '\">' +\r\n                          i +\r\n                          \"</a></li>\"\r\n                      );\r\n                    }\r\n                  }\r\n                  html.push(\r\n                    '<li><a href=\"#\" class=\"page-next js-table-pager\" data-page=\"next\">&rsaquo;</a></li>'\r\n                  );\r\n                  html.push(\r\n                    '<li><a href=\"#\" class=\"page-last js-table-pager\" data-page=\"last\">&raquo;</a></li>'\r\n                  );\r\n                  html.push(\r\n                    '<li><input id=\"data-table-input\" type=\"number\" min=\"1\" max=\"'+totalPages+'\" value=\"' +\r\n                      currentPage +\r\n                      '\"></input>&nbsp of &nbsp' +\r\n                      totalPages +\r\n                      \" Pages</li>\"\r\n                  );\r\n                    $pTable.empty().html(html.join(''));\r\n\r\n                    $pTable.find('[data-page=\"first\"]').attr('href', pagination.url.first);\r\n                    $pTable.find('[data-page=\"last\"]').attr('href', pagination.url.last);\r\n\r\n                    if (pagination.url.next) {\r\n                      $pTable.find('[data-page=\"next\"]').attr('href', pagination.url.next).show();\r\n                  } else {\r\n                      $pTable.find('[data-page=\"next\"]').hide();\r\n                  }\r\n                    if (pagination.url.prev) {\r\n                      $pTable.find('[data-page=\"previous\"]').attr('href', pagination.url.prev).show();\r\n                  } else {\r\n                      $pTable.find('[data-page=\"previous\"]').hide();\r\n                  }\r\n                }\r\n            }\r\n        });\r\n\r\n        var throttledSearch = $.fn.dataTable.util.throttle(\r\n            function () {\r\n                $dataTable.search(this.value);\r\n                $dataTable.draw();\r\n            },\r\n            250\r\n        );\r\n\r\n        $(document).on('input', '#data-table-input', function () {\r\n          var value = parseInt($(this).val());\r\n          if (value < parseInt($(this).attr('min'))) {\r\n            value = parseInt($(this).attr('min'));\r\n        }\r\n        else if (value > parseInt($(this).attr('max'))) {\r\n            value = parseInt($(this).attr('max'));\r\n        }\r\n        $(this).val(value);\r\n      });\r\n\r\n        $(document).off('click', '.js-table-pager').on('click', '.js-table-pager', function (e) {\r\n            e.preventDefault();\r\n            isBottomNavBar = false;\r\n            $dataTable.page($(this).data('page')).draw('page');\r\n        });\r\n        $(document).on('change', '#data-table-input', function (e) {\r\n          e.preventDefault();\r\n          $dataTable.page(e.target.value - 1).draw('page');\r\n      });\r\n      $(document).on('click', '.scrollToBottom', function(e){\r\n        e.preventDefault();\r\n        isBottomNavBar  = true;\r\n      });\r\n        if ($(config.search.input).length) {\r\n            $(document).off('keyup', config.search.input).on('keyup', config.search.input, throttledSearch);\r\n        }\r\n\r\n        if ($(config.search.form).length) {\r\n            $(document).off('submit', config.search.form).on('submit', config.search.form, function (e) {\r\n                e.preventDefault();\r\n                throttledSearch();\r\n            });\r\n        }\r\n\r\n        $(document).off('submit', config.filter).on('submit', config.filter, function (e) {\r\n            e.preventDefault();\r\n\r\n            var $btn = $(this).find('[type=\"submit\"]');\r\n\r\n            $btn.text($btn.data('text-progress'));\r\n            throttledSearch();\r\n        });\r\n\r\n        $(document).off('click', '.js-modal-table tbody tr').on('click', '.js-modal-table tbody tr', function () {\r\n            selectRow(this);\r\n        });\r\n    };\r\n\r\n    var initForm = function(config) {\r\n        var $formEl = $(config.form);\r\n        var $form = $formEl.ajaxForm({\r\n            clearForm: ($.trim($formEl.data('reset')) === '1'),\r\n            resetForm: ($.trim($formEl.data('reset')) === '1'),\r\n            beforeSubmit: function () {\r\n                var $btn = $(config.btn);\r\n\r\n                $btn.text($btn.data('text-progress'));\r\n                clearAlert();\r\n\r\n                if (config.beforeSubmitCb) {\r\n                    config.beforeSubmitCb();\r\n                }\r\n            },\r\n            success: function (responseText, statusText, xhr, $form) {\r\n                if (config.successCb) {\r\n                    config.successCb(responseText, statusText, xhr, $form);\r\n                } else {\r\n                    showAlert(responseText.msg, 'success');\r\n                }\r\n\r\n                if ($.trim($form.data('redirect')) !== '') {\r\n                    setTimeout(function () {\r\n                        window.location = $form.data('redirect');\r\n                    }, 3000);\r\n                }\r\n\r\n                if ($.trim(responseText.redirect) !== '') {\r\n                    setTimeout(function () {\r\n                        window.location = responseText.redirect;\r\n                    }, 3000);\r\n                }\r\n\r\n                $form.find('[name=\"comments\"]').val('');\r\n                $form.find('input[type=\"file\"]').val('');\r\n                $form.find('.js-file-selected').text('-');\r\n            },\r\n            error: function (xhr, status, error) {\r\n                var errors = JSON.parse(xhr.responseText);\r\n\r\n                if (errors.type === 'dialog') {\r\n                    showDialog(errors.msg, errors.confirm);\r\n                } else {\r\n                    showFormErrors(errors.errors, $formEl);\r\n                }\r\n\r\n                if (config.errorCb) {\r\n                    config.errorCb(xhr, status, error);\r\n                }\r\n            },\r\n            complete: function () {\r\n                var $btn = $(config.btn);\r\n                $btn.text($btn.data('text-default'));\r\n\r\n                if (config.completeCb) {\r\n                    config.completeCb();\r\n                }\r\n            }\r\n        });\r\n\r\n        $form.find('input, select, textarea').on('change keyup', debounce(function () {\r\n            var $this = $(this);\r\n\r\n            $this.closest('.form-group').removeClass('has-error');\r\n            $this.closest('.form-group').find('.help-block').remove();\r\n        }, 250));\r\n\r\n        if ($(config.btn).length && !$.contains($formEl[0], $(config.btn)[0])) {\r\n            $(config.btn).off('click').on('click', function (e) {\r\n                e.preventDefault();\r\n                $formEl.submit();\r\n            });\r\n        }\r\n    };\r\n\r\n    var updateDocuments = function (cb) {\r\n        var $container = $('.section-documents');\r\n        var projectId  = $container.data('project-id');\r\n        var data       = {\r\n            id: $container.data('id'),\r\n            type: $container.data('type'),\r\n        };\r\n\r\n        $('[data-toggle=\"tooltip\"]').tooltip('destroy');\r\n\r\n        $.get('/documents', data, function (resp) {\r\n            $container.html(Mustache.render(docTmpl, resp));\r\n            documents = resp.documents;\r\n        }).always(function () {\r\n            $('[data-toggle=\"tooltip\"]').tooltip();\r\n\r\n            if (cb) {\r\n                cb();\r\n            }\r\n        });\r\n    };\r\n\r\n    var updateUpdatedBy = function () {\r\n        $.get(meta_url, function (resp) {\r\n            updateBindings(resp);\r\n        });\r\n    };\r\n\r\n    var loadComments = function ($el) {\r\n        var url = $el.data('url');\r\n        var html = [];\r\n\r\n        $el.html('Loading comments...');\r\n\r\n        $.get(url, function (res) {\r\n            if (res.length) {\r\n                $.each(res, function (index, val) {\r\n                    html.push('<div class=\"media\">');\r\n                        html.push('<div class=\"media-body\">');\r\n                            html.push('<p class=\"media-heading\"><strong>' + val.name +'</strong> <small class=\"text-muted\" title=\"' + val.date +'\">' + val.diff + '</small></p>');\r\n                            html.push(val.comment);\r\n                        html.push('</div>');\r\n                    html.push('</div>');\r\n\r\n                    if (index < (res.length -1)) {\r\n                        html.push('<hr style=\"margin:10px 0;\">');\r\n                    }\r\n                });\r\n\r\n                $('.js-comments-count').text(res.length);\r\n            } else {\r\n                html.push('No comments found.');\r\n            }\r\n\r\n            $el.html(html.join(''));\r\n        });\r\n    };\r\n    \r\n    $(document).ready(function () {\r\n        if ($('.js-well-comments').length) {\r\n            $('.js-toggle-comments').on('click', function (e) {\r\n                e.preventDefault();\r\n                var $this = $(this);\r\n\r\n                if ($this.text() === 'Hide') {\r\n                    $this.text('Show');\r\n                } else {\r\n                    $this.text('Hide');\r\n                }\r\n\r\n                $('.js-well-comments').toggle();\r\n            });\r\n\r\n            loadComments($('.js-well-comments'));\r\n        }\r\n\r\n        initForm({\r\n            form: '.js-form',\r\n            btn: '.js-form [type=\"submit\"]',\r\n            successCb: function (data) {\r\n                showAlert(data.msg, 'success');\r\n\r\n                if (typeof meta_url !== 'undefined') {\r\n                    updateUpdatedBy();\r\n                }\r\n\r\n                loadComments($('.js-well-comments'));\r\n            }\r\n        });\r\n\r\n        initForm({\r\n            form: '.js-form-comment',\r\n            btn: '.js-form-comment [type=\"submit\"]',\r\n            successCb: function (data) {\r\n                showAlert(data.msg, 'success');\r\n\r\n                if (typeof meta_url !== 'undefined') {\r\n                    updateUpdatedBy();\r\n                }\r\n\r\n                loadComments($('.js-well-comments'));\r\n            }\r\n        });\r\n\r\n        $(document).on('change', '.js-input-file', function () {\r\n            var $this    = $(this);\r\n            var filepath = $this.val();\r\n            var basename = $.trim(filepath.replace(/\\\\/g,'/').replace(/.*\\//, ''));\r\n\r\n            if ($.trim($this.data('target')) !== '') {\r\n                $($this.data('target')).text(basename);\r\n            } else {\r\n                $('.js-file-selected').text(basename);\r\n            }\r\n        });\r\n\r\n        $('.close[data-dismiss=\"alert\"]').on('click', function (e) {\r\n            e.preventDefault();\r\n            clearAlert();\r\n        });\r\n\r\n        $('.js-datepicker').each(function() {\r\n            var $this = $(this);\r\n\r\n            $($this).datepicker({\r\n              format: 'dd/mm/yyyy',\r\n              autoHide: true,\r\n            });\r\n        });\r\n\r\n        $('.js-datepicker-disable-future').each(function() {\r\n            var $this = $(this);\r\n\r\n            $($this).datepicker({\r\n              format: 'dd/mm/yyyy',\r\n              autoHide: true,\r\n              endDate: \"today\",\r\n            });\r\n        });\r\n\r\n        $('.js-select').each(function () {\r\n            $(this).select2();\r\n        });\r\n\r\n        if ($('.js-stretch').length) {\r\n            autosize($('.js-stretch'));\r\n        }\r\n\r\n        // On page load, retrieve donors list\r\n        if ($('.section-documents').length) {\r\n            updateDocuments();\r\n        }\r\n\r\n        $('#modal-create-document').on('shown.bs.modal', function () {\r\n            $('[name=\"documentable_type\"]').val(documentable_type);\r\n            $('[name=\"documentable_id\"]').val(documentable_id);\r\n\r\n            initForm({\r\n                form: '#modal-create-document .js-modal-form',\r\n                btn: '#modal-create-document .btn-submit-modal-form',\r\n                successCb: function (responseText, statusText, xhr, $form) {\r\n                    updateDocuments(function () {\r\n                        $('#modal-create-document').modal('hide');\r\n                    });\r\n\r\n                    updateUpdatedBy();\r\n                }\r\n            });\r\n        });\r\n\r\n        // $('#modal-activity').on('shown.bs.modal', function () {\r\n        //     $('[name=\"causer_type\"]').val(causer_type);\r\n        //     $('[name=\"id\"]').val(id);\r\n\r\n        //     initForm({\r\n        //         form: '#modal-activity .js-modal-form',\r\n        //         btn: '#modal-activity .btn-submit-modal-form',\r\n        //     });\r\n        // });\r\n\r\n        $('#modal-edit-document').on('shown.bs.modal', function (e) {\r\n            var $this = $(this);\r\n            var $el   = $(e.relatedTarget);\r\n            var docId = parseInt($el.data('id'), 10);\r\n\r\n            $.each(documents, function (ind, val) {\r\n                if (val.id === docId) {\r\n                    $this.find('.js-file-selected').text(val.filename);\r\n                    $this.find('[name=\"type\"]').val(val.type);\r\n                    $this.find('[name=\"comments\"]').val(val.comments_raw);\r\n                    autosize.update($this.find('.js-stretch'));\r\n                }\r\n            });\r\n\r\n            $('[name=\"documentable_type\"]').val(documentable_type);\r\n            $('[name=\"documentable_id\"]').val(documentable_id);\r\n            $this.find('.js-modal-form').attr('action', $el.data('edit-url'));\r\n\r\n            initForm({\r\n                form: '#modal-edit-document .js-modal-form',\r\n                btn: '#modal-edit-document .btn-submit-modal-form',\r\n                successCb: function (responseText, statusText, xhr, $form) {\r\n                    updateDocuments(function () {\r\n                        $('#modal-edit-document').modal('hide');\r\n                    });\r\n\r\n                    updateUpdatedBy();\r\n                }\r\n            });\r\n        });\r\n\r\n        $('#modal-edit-document').on('hidden.bs.modal', function (e) {\r\n            $(this).find('.js-modal-form').attr('action', '#');\r\n        });\r\n\r\n        $('#modal-create-document').on('hide.bs.modal', function () {\r\n            var $this = $(this);\r\n\r\n            $this.find('.js-file-selected').text('-');\r\n            $this.find('.js-modal-form')[0].reset();\r\n        });\r\n\r\n        // $('#modal-activity').on('hide.bs.modal', function () {\r\n        //     var $this = $(this);\r\n\r\n        //     $this.find('.js-file-selected').text('-');\r\n        //     $this.find('.js-modal-form')[0].reset();\r\n        // });\r\n\r\n\r\n        $(document).on('click', '.js-delete-document', function (e) {\r\n            e.preventDefault();\r\n\r\n            var $this = $(this);\r\n\r\n            showDialog('Are you sure you want to delete this document?', true, function () {\r\n                $this.find('.fa').removeClass('fa-times').addClass('fa-spinner fa-pulse fa-fw');\r\n\r\n                $.post($this.data('delete-url'), function (resp) {\r\n                    updateDocuments();\r\n                    updateUpdatedBy();\r\n                }).fail(function () {\r\n                    showAlert('Something went wrong, please try again later.', 'danger');\r\n                }).always(function () {\r\n                    $this.find('.fa').removeClass('fa-spinner fa-pulse fa-fw').addClass('fa-times');\r\n                });\r\n            });\r\n        });\r\n    });\r\n\r\n    if ($('.yearly-reports').length) {\r\n        $( \"#year\" ).change(function() {\r\n            var action = document.getElementById(\"yearlyReports\").action;\r\n            var prevYear = document.getElementById(\"btnSubmit\").value;\r\n            var selectedYear = document.getElementById(\"year\").value;\r\n\r\n            var new_action = action.replace(prevYear, selectedYear);\r\n            document.getElementById(\"btnSubmit\").value = selectedYear;\r\n            document.getElementById(\"yearlyReports\").action = new_action;\r\n        });\r\n    }\r\n\r\n    if ($('.date-range-reports').length) {\r\n\r\n          var new_action;\r\n          var split_url;\r\n          var split_date;\r\n\r\n        $( \"#date_start\" ).change(function() {\r\n            var date_start = document.getElementById(\"date_start\").value.split(\"/\");\r\n            var new_start = date_start[2] + '-' + date_start[1] + '-' + date_start[0];\r\n            var action = document.getElementById(\"dateRangeReports\").action;\r\n\r\n            split_url = action.split(\"downloaddaterange/\");\r\n            split_date = split_url[1].split(\"/\");\r\n            new_action = split_url[0] + 'downloaddaterange/' + new_start + '/' + split_date[1];\r\n\r\n            document.getElementById(\"dateRangeReports\").action = new_action;\r\n        });\r\n\r\n        $( \"#date_end\" ).change(function() {\r\n            var date_end = document.getElementById(\"date_end\").value.split(\"/\");\r\n            var new_end = date_end[2] + '-' + date_end[1] + '-' + date_end[0];\r\n            var action = document.getElementById(\"dateRangeReports\").action;\r\n\r\n            split_url = action.split(\"downloaddaterange/\");\r\n            split_date = split_url[1].split(\"/\");\r\n            new_action = split_url[0] + 'downloaddaterange/' + split_date[0] + '/' + new_end;\r\n\r\n            document.getElementById(\"dateRangeReports\").action = new_action;\r\n        });\r\n\r\n        $('#modal-activity').on('shown.bs.modal', function () {\r\n            initDatatable({\r\n                table: '#modal-activity .js-modal-table',\r\n                filter: '#modal-activity .js-modal-table-filter',\r\n                search: {\r\n                    form: '#modal-activity .js-table-search-form',\r\n                    input: '#modal-activity .js-table-search-input',\r\n                },\r\n                pagination: {\r\n                    basic: '#modal-activity .pagination-basic',\r\n                    table: '',\r\n                },\r\n                columns: [\r\n                    {\r\n                        data: 'id',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'event',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'subjectID',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'properties',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'updated_at',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'updated_by',\r\n                        className: 'text-center',\r\n                    },\r\n                ]\r\n            });\r\n        })\r\n    }\r\n\r\n    // Expose some functions to global window object\r\n    window.debounce        = debounce;\r\n    window.showAlert       = showAlert;\r\n    window.showDialog      = showDialog;\r\n    window.initDatatable   = initDatatable;\r\n    window.initForm        = initForm;\r\n    window.updateBindings  = updateBindings;\r\n    window.numberFormat    = numberFormat;\r\n    window.updateUpdatedBy = updateUpdatedBy;\r\n})(jQuery);\r\n"]}
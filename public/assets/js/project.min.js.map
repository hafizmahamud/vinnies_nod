{"version":3,"sources":["project.js"],"names":["$","updateDetailsAjax","donorTmpl","html","Mustache","parse","updateDetails","cb","data","currency","find","val","local_value","undefined","readyState","abort","post","project_info_url","resp","updateBindings","is_fully_paid","prop","always","updateDonors","$container","projectId","get","project_donors_url","project_id","render","document","ready","length","initDatatable","table","filter","search","form","input","pagination","basic","columns","className","type","row","on","initForm","btn","beforeSubmitCb","empty","hide","successCb","responseText","statusText","xhr","$form","$p1","beneficiary_id","attr","modal","closest","append","$p2","overseas_conference_id","each","this","toggleClass","updateUpdatedBy","e","$this","$el","relatedTarget","DataTable","destroy","preventDefault","showDialog","text","noop","fail","showAlert","donor_local_conference_id","donor_local_conference_name","quarter_year","pick.datepicker","month","date","getMonth","quarter","Math","floor","parseInt","getFullYear","msg","split","formData","filters","country","status","project_type","state","is_awaiting_support","project_completed","completion_report_received","value","window","location","project_export_url","param","jQuery"],"mappings":"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","file":"project.min.js","sourcesContent":["/* global project_info_url */\r\n/* global project_donors_url */\r\n/* global project_export_url */\r\n/* global updateBindings */\r\n/* global Mustache */\r\n/* global rome */\r\n/* global initDatatable */\r\n/* global initForm */\r\n/* global showDialog */\r\n/* global showAlert */\r\n/* global debounce */\r\n/* global updateUpdatedBy */\r\n\r\n'use strict';\r\n\r\n(function ($) {\r\n    var updateDetailsAjax;\r\n    var donorTmpl = $('#mustache-donors').html();\r\n\r\n    Mustache.parse(donorTmpl);\r\n\r\n    var updateDetails = function (cb) {\r\n        var data = {\r\n            currency: $('[name=\"currency\"]').find('option:selected').val(),\r\n            local_value: $('[name=\"local_value\"]').val(),\r\n        };\r\n\r\n        if (updateDetailsAjax !== undefined) {\r\n            if (updateDetailsAjax.readyState > 0 && updateDetailsAjax.readyState < 4) {\r\n                updateDetailsAjax.abort();\r\n            }\r\n        }\r\n\r\n        // $('#exchange_rate, #au_value').addClass('loading');\r\n\r\n        updateDetailsAjax = $.post(project_info_url, data, function (resp) {\r\n            updateBindings(resp, function(resp) {\r\n                if (resp.is_fully_paid === 'No') {\r\n                    $('#is_fully_paid').find('option[value=\"0\"]').prop('selected', true);\r\n                } else {\r\n                    $('#is_fully_paid').find('option[value=\"1\"]').prop('selected', true);\r\n                }\r\n            });\r\n        }).always(function () {\r\n            // $('#exchange_rate, #au_value').removeClass('loading');\r\n\r\n            if (cb) {\r\n                cb();\r\n            }\r\n        });\r\n    };\r\n\r\n    var updateDonors = function (cb) {\r\n        var $container = $('.section-donors');\r\n        var projectId = $container.data('project-id');\r\n\r\n        $.get(project_donors_url, {project_id: projectId}, function (resp) {\r\n            $container.html(Mustache.render(donorTmpl, resp));\r\n        }).always(function () {\r\n            if (cb) {\r\n                cb();\r\n            }\r\n        });\r\n    };\r\n\r\n    $(document).ready(function () {\r\n        if ($('.js-table').length) {\r\n            initDatatable({\r\n                table: '.js-table',\r\n                filter: '.js-table-filter',\r\n                search: {\r\n                    form: '.js-table-search-form',\r\n                    input: '.js-table-search-input',\r\n                },\r\n                pagination: {\r\n                    basic: '.pagination-basic',\r\n                    table: '.pagination-table',\r\n                },\r\n                columns: [\r\n                    {\r\n                        data: 'id',\r\n                        className: 'text-center',\r\n                        render: function (data, type, row) {\r\n                            return '<a href=\"/projects/edit/' + data + '\">' + data + '</a>';\r\n                        },\r\n                    },\r\n                    {\r\n                        data: 'status',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'project_type',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'name',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'country',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'overseas_project_id',\r\n                        className: 'text-center',\r\n                        render: function (data, type, row) {\r\n                            if (data === 'N/A') {\r\n                                return data;\r\n                            }\r\n\r\n                            return '<a href=\"/overseas-conferences/edit/' + data + '\">' + data  + '</a>';\r\n                        },\r\n                    },\r\n                    {\r\n                        data: 'received_at',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'is_awaiting_support',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'state',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'au_value',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'is_fully_paid',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'balance_owing ',\r\n                        className: 'text-center',\r\n                    },\r\n                ]\r\n            });\r\n        }\r\n\r\n        $('#modal-beneficiary').on('shown.bs.modal', function () {\r\n            initDatatable({\r\n                table: '#modal-beneficiary .js-modal-table',\r\n                filter: '#modal-beneficiary .js-modal-table-filter',\r\n                search: {\r\n                    form: '',\r\n                    input: '',\r\n                },\r\n                pagination: {\r\n                    basic: '#modal-beneficiary .pagination-basic',\r\n                    table: '',\r\n                },\r\n                columns: [\r\n                    {\r\n                        data: 'id',\r\n                        className: 'text-center',\r\n                        render: function (data, type, row) {\r\n                            return '<div class=\"checkbox checkbox-warning\"><input type=\"checkbox\" name=\"beneficiary_id\" value=\"' + data + '\"><label></label></div>';\r\n                        },\r\n                    },\r\n                    {\r\n                        data: 'name',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'country',\r\n                        className: 'text-center',\r\n                    },\r\n                ]\r\n            });\r\n\r\n            initForm({\r\n                form: '#modal-beneficiary .js-modal-form',\r\n                btn: '#modal-beneficiary .btn-submit-modal-form',\r\n                beforeSubmitCb: function () {\r\n                    $('#modal-beneficiary .js-modal-form').find('[data-error]').empty().hide();\r\n                },\r\n                successCb: function (responseText, statusText, xhr, $form) {\r\n                    updateBindings(responseText, function (data) {\r\n                        var $p1 = $('[data-bind=\"beneficiary_name\"]');\r\n\r\n                        $('.js-form [name=\"beneficiary_id\"]').val(data.beneficiary_id);\r\n                        $('#modal-beneficiary .js-modal-table').attr('data-selected-id', data.beneficiary_id);\r\n                        $('#modal-beneficiary').modal('hide');\r\n                        $p1.closest('p').find('a').append($p1);\r\n                    });\r\n                }\r\n            });\r\n        });\r\n\r\n        $('#modal-os-conf').on('shown.bs.modal', function () {\r\n            initDatatable({\r\n                table: '#modal-os-conf .js-modal-table',\r\n                filter: '#modal-os-conf .js-modal-table-filter',\r\n                search: {\r\n                    form: '#modal-os-conf .js-table-search-form',\r\n                    input: '#modal-os-conf .js-table-search-input',\r\n                },\r\n                pagination: {\r\n                    basic: '#modal-os-conf .pagination-basic',\r\n                    table: '',\r\n                },\r\n                columns: [\r\n                    {\r\n                        data: 'select',\r\n                        className: 'text-center',\r\n                        render: function (data, type, row) {\r\n                            return '<div class=\"checkbox checkbox-warning\"><input type=\"checkbox\" name=\"overseas_conference_id\" value=\"' + data + '\"><label></label></div>';\r\n                        },\r\n                    },\r\n                    {\r\n                        data: 'id',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'name',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'country',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'central_council',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'particular_council',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'parish',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'is_active',\r\n                        className: 'text-center',\r\n                    },\r\n                ]\r\n            });\r\n\r\n            initForm({\r\n                form: '#modal-os-conf .js-modal-form',\r\n                btn: '#modal-os-conf .btn-submit-modal-form',\r\n                beforeSubmitCb: function () {\r\n                    $('#modal-os-conf .js-modal-form').find('[data-error]').empty().hide();\r\n                },\r\n                successCb: function (responseText, statusText, xhr, $form) {\r\n                    updateBindings(responseText, function (data) {\r\n                        var $p1 = $('[data-bind=\"overseas_conference_id\"]');\r\n                        var $p2 = $('[data-bind=\"overseas_conference_name\"]');\r\n\r\n                        if (data.overseas_conference_id === 'N/A') {\r\n                            $('.js-form [name=\"overseas_conference_id\"]').val('');\r\n                            $('#modal-os-conf .js-modal-table').attr('data-selected-id', '');\r\n                            $p1.closest('p').append($p1);\r\n                            $p2.closest('p').append($p2);\r\n                        } else {\r\n                            $('.js-form [name=\"overseas_conference_id\"]').val(data.overseas_conference_id);\r\n                            $('#modal-os-conf .js-modal-table').attr('data-selected-id', data.overseas_conference_id);\r\n                            $p1.closest('p').find('a').append($p1);\r\n                            $p2.closest('p').find('a').append($p2);\r\n                        }\r\n\r\n                        $('.row-os-conf p').each(function () {\r\n                            var $this = $(this);\r\n                            $this.toggleClass('text-muted', (data.overseas_conference_id === 'N/A'));\r\n                        });\r\n\r\n                        $('#modal-os-conf').modal('hide');\r\n                    });\r\n                }\r\n            });\r\n        });\r\n\r\n        $('#modal-create-donor').on('shown.bs.modal', function () {\r\n            initDatatable({\r\n                table: '#modal-create-donor .js-modal-table',\r\n                filter: '#modal-create-donor .js-modal-table-filter',\r\n                search: {\r\n                    form: '#modal-create-donor .js-table-search-form',\r\n                    input: '#modal-create-donor .js-table-search-input',\r\n                },\r\n                pagination: {\r\n                    basic: '#modal-create-donor .pagination-basic',\r\n                    table: '',\r\n                },\r\n                columns: [\r\n                    {\r\n                        data: 'select',\r\n                        className: 'text-center',\r\n                        render: function (data, type, row) {\r\n                            return '<div class=\"checkbox checkbox-warning\"><input type=\"checkbox\" name=\"local_conference_id\" value=\"' + data + '\"><label></label></div>';\r\n                        },\r\n                    },\r\n                    {\r\n                        data: 'id',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'name',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'state',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'regional_council',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'diocesan_council_id',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'parish',\r\n                        className: 'text-center',\r\n                    },\r\n                ]\r\n            });\r\n\r\n            initForm({\r\n                form: '#modal-create-donor .js-modal-form',\r\n                btn: '#modal-create-donor .btn-submit-modal-form',\r\n                beforeSubmitCb: function () {\r\n                    $('#modal-create-donor .js-modal-form').find('[data-error]').empty().hide();\r\n                },\r\n                successCb: function (responseText, statusText, xhr, $form) {\r\n                    updateDonors(function () {\r\n                        $('#modal-create-donor').modal('hide');\r\n                    });\r\n\r\n                    updateUpdatedBy();\r\n                }\r\n            });\r\n        });\r\n\r\n        $('#modal-edit-donor').on('shown.bs.modal', function () {\r\n            initDatatable({\r\n                table: '#modal-edit-donor .js-modal-table',\r\n                filter: '#modal-edit-donor .js-modal-table-filter',\r\n                search: {\r\n                    form: '#modal-edit-donor .js-table-search-form',\r\n                    input: '#modal-edit-donor .js-table-search-input',\r\n                },\r\n                pagination: {\r\n                    basic: '#modal-edit-donor .pagination-basic',\r\n                    table: '',\r\n                },\r\n                columns: [\r\n                    {\r\n                        data: 'select',\r\n                        className: 'text-center',\r\n                        render: function (data, type, row) {\r\n                            return '<div class=\"checkbox checkbox-warning\"><input type=\"checkbox\" name=\"local_conference_id\" value=\"' + data + '\"><label></label></div>';\r\n                        },\r\n                    },\r\n                    {\r\n                        data: 'id',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'name',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'state',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'regional_council',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'diocesan_council_id',\r\n                        className: 'text-center',\r\n                    },\r\n                    {\r\n                        data: 'parish',\r\n                        className: 'text-center',\r\n                    },\r\n                ]\r\n            });\r\n\r\n            initForm({\r\n                form: '#modal-edit-donor .js-modal-form',\r\n                btn: '#modal-edit-donor .btn-submit-modal-form',\r\n                beforeSubmitCb: function () {\r\n                    $('#modal-edit-donor .js-modal-form').find('[data-error]').empty().hide();\r\n                },\r\n                successCb: function (responseText, statusText, xhr, $form) {\r\n                    updateDonors(function () {\r\n                        $('#modal-edit-donor').modal('hide');\r\n                    });\r\n\r\n                    updateUpdatedBy();\r\n                }\r\n            });\r\n        });\r\n\r\n        $('#modal-edit-donor').on('show.bs.modal', function (e) {\r\n            var $this = $(this);\r\n            var $el   = $(e.relatedTarget);\r\n\r\n            $this.find('.js-modal-table').attr('data-selected-id', $el.data('local-conference-id'));\r\n            $this.find('.js-modal-form').attr('action', $el.data('edit-url'));\r\n        });\r\n\r\n        $('#modal-edit-donor').on('hidden.bs.modal', function (e) {\r\n            var $this = $(this);\r\n\r\n            $this.find('.js-modal-table').attr('data-selected-id', '');\r\n            $this.find('.js-modal-form').attr('action', '#');\r\n\r\n            if ($this.find('.js-modal-table').DataTable()) {\r\n                $this.find('.js-modal-table').DataTable().destroy();\r\n            }\r\n        });\r\n\r\n        // Dynamic update form exchange rate\r\n        // $('[name=\"currency\"], [name=\"local_value\"]').on('keyup change', debounce(function () {\r\n        //     updateDetails($.noop);\r\n        // }, 250));\r\n\r\n        // On page load, retrieve donors list\r\n        if ($('.section-donors').length) {\r\n            updateDonors();\r\n        }\r\n\r\n        // On delete donor\r\n        $(document).on('click', '.js-delete-donor', function (e) {\r\n            e.preventDefault();\r\n\r\n            var $this = $(this);\r\n\r\n            showDialog('Are you sure you want to delete this Donor and its associated contributions?', true, function () {\r\n                $this.text($this.data('text-progress'));\r\n\r\n                $.post($this.data('delete-url'), function (resp) {\r\n                    updateDonors(updateDetails($.noop));\r\n                    updateUpdatedBy();\r\n                }).fail(function () {\r\n                    showAlert('Something went wrong, please try again later.', 'danger');\r\n                }).always(function () {\r\n                    $this.text($this.data('text-default'));\r\n                });\r\n            });\r\n        });\r\n\r\n        $('#modal-create-contribution, #modal-edit-contribution').on('shown.bs.modal', function (e) {\r\n            var $el = $(e.relatedTarget);\r\n\r\n            updateBindings({\r\n                donor_local_conference_id: $el.data('local-conference-id'),\r\n                donor_local_conference_name: $el.data('local-conference-name'),\r\n            });\r\n        });\r\n\r\n        $('#modal-create-contribution').on('hidden.bs.modal', function (e) {\r\n            $(this).find('[name=\"paid_at\"]').val('');\r\n            $(this).find('[name=\"amount\"]').val('');\r\n            $(this).find('[name=\"donor_id\"]').val('');\r\n\r\n            updateBindings({\r\n                quarter_year: '',\r\n            });\r\n        });\r\n\r\n        $('#modal-create-contribution, #modal-edit-contribution').on('shown.bs.modal', function (e) {\r\n            var $this = $(this);\r\n\r\n            $this.on({\r\n              'pick.datepicker': function (e) {\r\n                  var month = e.date.getMonth()+1;\r\n                  var quarter = Math.floor((parseInt(month, 10) + 2) / 3);\r\n\r\n                  updateBindings({\r\n                      quarter_year: 'Q' + quarter + ':' + e.date.getFullYear(),\r\n                  });\r\n              }\r\n            });\r\n\r\n            // rome($(this).find('[name=\"paid_at\"]')[0]).on('data', function (value) {\r\n            //     var month   = value.split('/');\r\n            //     var quarter = Math.floor((parseInt(month[1], 10) + 2) / 3);\r\n            //\r\n            //     updateBindings({\r\n            //         quarter_year: 'Q' + quarter + ':' + month[2],\r\n            //     });\r\n            // });\r\n        });\r\n\r\n        $('#modal-create-contribution').on('show.bs.modal', function (e) {\r\n            $(this).find('[name=\"donor_id\"]').val($(e.relatedTarget).data('id'));\r\n        });\r\n\r\n        \r\n        initForm({\r\n            form: '#update-projects .js-form',\r\n            btn: '#update-projects .btn-update-form',\r\n            beforeSubmitCb: function () {\r\n                $('#update-projects .js-form').find('[data-error]').empty().hide();\r\n            },\r\n            successCb: function (data) {\r\n                showAlert(data.msg, 'success');\r\n\r\n                updateDonors(\r\n                    updateDetails()\r\n                );\r\n\r\n                updateUpdatedBy();\r\n            }\r\n        });\r\n\r\n        $('#modal-create-contribution').on('shown.bs.modal', function (e) {\r\n            initForm({\r\n                form: '#modal-create-contribution .js-modal-form',\r\n                btn: '#modal-create-contribution .btn-submit-modal-form',\r\n                beforeSubmitCb: function () {\r\n                    $('#modal-create-contribution .js-modal-form').find('[data-error]').empty().hide();\r\n                },\r\n                successCb: function (responseText, statusText, xhr, $form) {\r\n                    updateDonors(\r\n                        updateDetails(function () {\r\n                            $('#modal-create-contribution').modal('hide');\r\n                        })\r\n                    );\r\n\r\n                    updateUpdatedBy();\r\n                }\r\n            });\r\n        });\r\n\r\n        $('#modal-edit-contribution').on('show.bs.modal', function (e) {\r\n            var $this = $(this);\r\n            var $el   = $(e.relatedTarget);\r\n\r\n            $this.find('[name=\"paid_at\"]').val($el.data('paid-at'));\r\n            $this.find('[name=\"amount\"]').val($el.data('amount'));\r\n            $this.find('[name=\"donor_id\"]').val($el.data('local-conference-id'));\r\n            $this.find('.js-modal-form').attr('action', $el.data('edit-url'));\r\n\r\n            var month   = $el.data('paid-at').split('/');\r\n            var quarter = Math.floor((parseInt(month[1], 10) + 2) / 3);\r\n\r\n            updateBindings({\r\n                quarter_year: 'Q' + quarter + ':' + month[2],\r\n            });\r\n        });\r\n\r\n        $('#modal-edit-contribution').on('hidden.bs.modal', function (e) {\r\n            var $this = $(this);\r\n\r\n            $this.find('[name=\"paid_at\"]').val('');\r\n            $this.find('[name=\"amount\"]').val('');\r\n            $this.find('[name=\"donor_id\"]').val('');\r\n            $this.find('.js-modal-form').attr('action', '#');\r\n        });\r\n\r\n        $('#modal-edit-contribution').on('shown.bs.modal', function (e) {\r\n            initForm({\r\n                form: '#modal-edit-contribution .js-modal-form',\r\n                btn: '#modal-edit-contribution .btn-submit-modal-form',\r\n                beforeSubmitCb: function () {\r\n                    $('#modal-edit-contribution .js-modal-form').find('[data-error]').empty().hide();\r\n                },\r\n                successCb: function (responseText, statusText, xhr, $form) {\r\n                    updateDonors(\r\n                        updateDetails(function () {\r\n                            $('#modal-edit-contribution').modal('hide');\r\n                        })\r\n                    );\r\n\r\n                    updateUpdatedBy();\r\n                }\r\n            });\r\n        });\r\n\r\n        $(document).on('click', '.js-delete-contribution', function (e) {\r\n            e.preventDefault();\r\n\r\n            var $this = $(this);\r\n\r\n            showDialog('Are you sure you want to delete this payment?', true, function () {\r\n                $this.text($this.data('text-progress'));\r\n\r\n                $.post($this.data('delete-url'), function (resp) {\r\n                    updateDonors(updateDetails);\r\n                    updateUpdatedBy();\r\n                }).fail(function () {\r\n                    showAlert('Something went wrong, please try again later.', 'danger');\r\n                }).always(function () {\r\n                    $this.text($this.data('text-default'));\r\n                });\r\n            });\r\n        });\r\n\r\n        $(document).on('click', '.js-btn-export-projects', function (e) {\r\n            e.preventDefault();\r\n\r\n            var formData = {\r\n                filters: {\r\n                    country: $('[name=\"country\"]').find('option:selected').val(),\r\n                    status: $('[name=\"status\"]').find('option:selected').val(),\r\n                    project_type: $('[name=\"project_type\"]').find('option:selected').val(),\r\n                    state: $('[name=\"state\"]').find('option:selected').val(),\r\n                    is_awaiting_support: $('[name=\"is_awaiting_support\"]').find('option:selected').val(),\r\n                    is_fully_paid: $('[name=\"is_fully_paid\"]').find('option:selected').val(),\r\n                    project_completed: $('[name=\"project_completed\"]').find('option:selected').val(),\r\n                    completion_report_received: $('[name=\"completion_report_received\"]').find('option:selected').val(),\r\n                },\r\n                search: {\r\n                    value: $('.js-table-search-input').val(),\r\n                }\r\n            };\r\n\r\n            window.location = project_export_url + '?' + $.param(formData);\r\n        });\r\n    });\r\n})(jQuery);\r\n"]}